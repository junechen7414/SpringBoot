# Spring Boot 基本概念

Spring Boot 開發中常用的基礎架構，通常會同時存在並互相配合。

## 1.1 Entity

*   Entity 代表資料庫中的一個資料表，用於將資料庫中的資料映射為 Java 物件。每個 Entity 實例對應到資料表中的一列。
    *   常用的註解包括：
        *   `@Entity`：標示此類別為一個 Entity。
        *   `@Id`：標示此欄位為資料表的主鍵。
        *   `@GeneratedValue`：指定主鍵的生成策略。
*   **範例：**[Product.java](demo/src/main/java/com/example/demo/entity/Product.java)

## 1.2 Repository

*   Repository 是一個介面，用於存取資料庫。Spring Data JPA 的 JpaRepository 介面繼承多個 Repository 介面，簡化資料庫操作，並提供預設的方法。`save()` 方法可以自動判斷 Entity 是否存在，若存在則更新，不存在則新增。
    *   `JpaRepository` 提供了許多預設的資料庫操作方法，例如：
        *   `save()`：儲存 Entity。
        *   `findById()`：根據 ID 查詢 Entity。
        *   `findAll()`：查詢所有 Entity。
        *   `deleteById()`：根據 ID 刪除 Entity。
*   **範例：**[ProductRepository.java](demo/src/main/java/com/example/demo/repository/ProductRepository.java)

## 1.3 Service

*   Service 用於處理業務邏輯，提供 Controller 的端點可以使用的服務。Service 通常會呼叫 Repository 來存取資料庫。
*   **範例：**[ProductService.java](demo/src/main/java/com/example/demo/service/ProductService.java)

## 1.4 Controller

*   Controller 是一個 Java 類別，用於接收和處理 HTTP 請求，將請求交給 Service 層處理。Controller 負責將處理結果轉換為 HTTP 回應。
*   **範例：**[ProductController.java](demo/src/main/java/com/example/demo/ProductController.java)

# 2. 資料庫操作

## 2.1 JPA Query Methods

*   **說明：** JPA Query Methods 是一種基於方法名稱自動生成 SQL 查詢的方法。Spring Data JPA 會根據方法名稱的規則，自動解析並生成對應的 SQL 查詢。
    *   方法名稱的規則：
        *   `findBy...`：根據屬性查詢。
        *   `findAllBy...`：查詢所有符合條件的 Entity。
        *   `countBy...`：統計符合條件的 Entity 數量。
        *   `deleteBy...`：根據屬性刪除 Entity。

```java
public interface ProductRepository extends JpaRepository<Product, Long> {
    List<Product> findByName(String name);
    List<Product> findByNameAndPrice(String name, Double price);
}
```

## 2.2 JPQL

*   **說明：** JPQL (Java Persistence Query Language) 是一種物件導向的查詢語言，類似於 SQL，但是操作的是 Entity 和屬性，而不是資料表和欄位。
    *   可以使用 `@Query` 註解來定義 JPQL 查詢。


```java
public interface ProductRepository extends JpaRepository<Product, Long> {
    @Query("SELECT p FROM Product p WHERE p.name = :name")
    List<Product> findProductsByNameJpql(@Param("name") String name);
}
```

## 2.3 Native SQL

*   **說明：** Native SQL 是一種直接使用資料庫原生 SQL 語法進行查詢的方法。
    *   可以使用 `@Query` 註解，並設定 `nativeQuery = true` 來定義 Native SQL 查詢。

```java
public interface ProductRepository extends JpaRepository<Product, Long> {
    @Query(value = "SELECT * FROM PRODUCTS WHERE name = :name", nativeQuery = true)
    List<Product> findProductsByNameNative(@Param("name") String name);
}
```

# 3. Stream API 與 Lambda 運算式

   **範例：** 在 `ProductService.java` 中，`getProductsAbovePrice` 方法使用 Stream API 和 Lambda 運算式來篩選出價格高於指定金額的商品。

# RESTful API

*   **說明：** RESTful API 是一種設計風格，用於建立網路服務。它定義了一組約束和原則，讓不同的系統可以透過標準的 HTTP 方法 (GET, POST, PUT, DELETE 等) 進行通訊和資料交換。Spring Boot 使用 `@RestController` 和 `@RequestMapping` (或 `@GetMapping`, `@PostMapping` 等) 註解建立 RESTful API。
    *   常用的註解包括：
        *   `@RestController`：標示此類別為 REST 控制器，負責處理 HTTP 請求。
        *   `@RequestMapping`：設定 API 的基礎路徑。
        *   `@GetMapping @PostMapping @PutMapping @DeleteMapping`：處理 GET POST PUT DELETE請求。
        *   `@RequestBody`：將請求內容轉換為 Java 物件,in this case Product物件。
        *   `@PathVariable`：從 URI 中獲取參數。
        *   `ResponseEntity`：封裝 HTTP 回應，可以設定狀態碼、Header 和 Body。
*   **範例：**[ProductController.java](demo/src/main/java/com/example/demo/ProductController.java)


# IoC/DI

*   **說明：** IoC (Inversion of Control) 是一種設計原則，目的是降低程式元件之間的耦合度。Spring 透過 DI (Dependency Injection) 實現 IoC。由 Spring IoC 容器負責建立和管理物件 (稱為 Bean) 以及它們之間的依賴關係，而不是由物件自己建立依賴。
    *   常用的註解包括：
        *   `@Autowired`：自動注入依賴的 Bean。
        *   `@Component`：標示此類別為一個 Bean，交由 Spring IoC 容器管理。
        *   `@Service`：標示此類別為一個 Service Bean。
        *   `@Repository`：標示此類別為一個 Repository Bean。
        *   `@Controller`：標示此類別為一個 Controller Bean。
*   **範例：**[ProductController.java](demo/src/main/java/com/example/demo/ProductController.java)

# AOP

*   **說明：** AOP (Aspect-Oriented Programming) 是一種程式設計範式，用於處理「橫切關注點」(Cross-Cutting Concerns)，例如日誌記錄、安全性檢查、交易管理等。這些功能通常散佈在多個業務邏輯中，AOP 可以將它們模組化為「切面」(Aspect)，並在指定的「連接點」(Join Point，例如方法執行) 應用「通知」(Advice，例如在方法執行前、後)。
    *   常用的註解包括：
        *   `@Aspect`：標示此類別為一個切面。
        *   `@Component`：讓 Spring IoC 容器管理此切面元件。
        *   `@Before`：前置通知，在連接點之前執行。
        *   `@After`：後置通知，在連接點之後執行。
        *   `@AfterReturning`：返回通知，在連接點成功返回後執行。
        *   `@AfterThrowing`：異常通知，在連接點拋出異常後執行。
        *   `@Around`：環繞通知，可以完全控制連接點的執行。
*   **範例：**[LoggingAspect.java](demo/src/main/java/com/example/demo/LoggingAspect.java)

# Gradle

*   **說明：** Gradle 是一個強大的自動化建置工具，用於管理專案的相依性 (Dependencies)、編譯原始碼、執行測試、打包應用程式等。Spring Boot 專案常使用 Gradle 或 Maven。
    *   常用的設定包括：
        *   `plugins`：定義使用的外掛，例如 `org.springframework.boot`。
        *   `dependencies`：列出專案所需的函式庫，例如 `spring-boot-starter-web` (Web 開發)、`spring-boot-starter-data-jpa` (資料存取)、`ojdbc11` (Oracle 驅動)。

# Swagger

*   **說明：** Swagger 是一個用於設計、建構、文檔化和使用 RESTful API 的工具。Spring Boot 可以使用 Swagger 來自動生成 API 文件。
    *   常用的註解包括：
        *   `@EnableOpenApi`：啟用 Swagger。
        *   `@Schema`：用於描述 API 的資料模型。
        *   `@Operation`：用於描述 API 的操作。
        *   `@Parameter`：用於描述 API 的參數。
        *   `@ApiResponse`：用於描述 API 的回應。
*   **範例：**

1.  在 `pom.xml` 或 `build.gradle` 中加入 Swagger 的相依性。
2.  在 Spring Boot 應用程式中加入 `@EnableOpenApi` 註解。
3.  使用 Swagger 提供的註解來描述 API。
